<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  

  <title>Always define a behavior for every valid precondition.</title>

  
  

  <meta name="description" content="A supplier must define a behavior (or postcondition) for every valid precondition. However, this does not mean the supplier must return successfully for ever...">

  <link rel="stylesheet" href="/software-design-rules/css/main.css">
  <link rel="canonical" href="https://jlapolla.github.io/software-design-rules/rules/e1023324-1686-4c0a-a2b8-dc8d3360ae9e/">
  <link rel="alternate" type="application/rss+xml" title="Software Design Rules" href="https://jlapolla.github.io/software-design-rules/feed.xml">
</head>


  <body>

    <header class="site-header">

  <div class="wrapper">

    <a class="site-title" href="/software-design-rules/">Software Design Rules</a>

    <nav class="site-nav">
      <a href="#" class="menu-icon">
        <svg viewBox="0 0 18 15">
          <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </a>

      <div class="trigger">
        
          
          <a class="page-link" href="/software-design-rules/about/">About</a>
          
        
          
        
          
        
          
        
          
          <a class="page-link" href="/software-design-rules/tags/">Tags</a>
          
        
      </div>
    </nav>

  </div>

</header>


    <div class="page-content">
      <div class="wrapper">
        <article class="post">

  <header class="post-header">
    <p class="post-meta">e1023324-1686-4c0a-a2b8-dc8d3360ae9e</p>
    <blockquote><p>Always define a behavior for every valid precondition.</p></blockquote>
    <ul class="undercover inline">
  
  
  
    
    
  
  
    
  
    
  
    
  
    
  
    
      <li><a href="/software-design-rules/tags/33623a95-ab93-4db4-a4f2-3164018777e3/"><span class="badge">half baked</span></a></li>
    
  
    
  
    
  
    
  
</ul>

  </header>

  <div class="post-content">
    <p>A <a href="https://www.eiffel.org/doc/glossary/Glossary#Supplier">supplier</a> must define a behavior (or <a href="https://www.eiffel.org/doc/glossary/Glossary#Postcondition">postcondition</a>) for every
valid precondition. However, this does not mean the supplier must return
successfully for every valid precondition. In fact, a valid precondition
may result in failure of the operation. A valid precondition does not
guarantee a successfull return, it only guarantees a defined behavior.
Compare with the discussion of undefined behaviors in <a href="/software-design-rules/rules/3c2010e2-5c44-42ba-80f8-02c7b8f6fa98/" title="Do not handle precondition violations.">3c2010e2</a>.</p>

<p>A supplier that violates the rule does not give it’s client enough
information to effectively use the supplier.</p>

<p>The rule complements <a href="/software-design-rules/rules/3c2010e2-5c44-42ba-80f8-02c7b8f6fa98/" title="Do not handle precondition violations.">3c2010e2</a></p>

<h2 id="something">Something</h2>

<p>In cases where a supplier can perform its duties
successfully, the defined behavior is (typcially) <em>“Return normally with the
correct postcondition”</em>. But there are other possibilities for a
<em>“defined behavior”</em>, such as:</p>

<ul>
  <li>Throw an exception.</li>
  <li>Do nothing.</li>
  <li>Loop forever.</li>
  <li>Crash the system.</li>
  <li>And more!</li>
</ul>

<p>Consider a <code class="highlighter-rouge">TokenValidator</code> class:</p>

<p>However, a supplier must also define what happens
when the precondition is met, but it is not able to perform its duties
for some other reason.</p>

<h2 id="preconditions-do-not-guarantee-success">Preconditions do not guarantee success</h2>

<p>Just because the client satisfies the precondition, it does not
necessarily mean the supplier will return successfully.</p>

<p>Consider a matrix algebra API:</p>

<figure class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span class="k">public</span> <span class="k">class</span> <span class="nc">MatrixAlgebra</span>
<span class="p">{</span>

  <span class="c1">// The inverse of a matrix.
</span>  <span class="k">public</span> <span class="k">static</span> <span class="n">Matrix</span> <span class="nf">Inverse</span><span class="p">(</span><span class="n">Matrix</span> <span class="n">m</span><span class="p">)</span> <span class="p">{</span> <span class="cm">/* ... */</span> <span class="p">}</span>
<span class="p">}</span></code></pre></figure>

<p>Let’s assume the precondition of <code class="highlighter-rouge">Matrix.Inverse</code> is <em>“<code class="highlighter-rouge">m</code> is a valid
<code class="highlighter-rouge">Matrix</code>“</em>. The rule states that <code class="highlighter-rouge">Matrix.Inverse</code> must have a defined
behavior for every valid precondition. In other words <code class="highlighter-rouge">Matrix.Inverse</code>
must have a defined behavior for every valid <code class="highlighter-rouge">Matrix m</code>, even if <code class="highlighter-rouge">m</code> is
not invertible.</p>

<p>Let’s define the behavior when <code class="highlighter-rouge">m</code> is invertible as: <em>“Return the
inverse of <code class="highlighter-rouge">m</code>“</em>. This is a typical behavior for success.</p>

<p>Let’s define the behavior when <code class="highlighter-rouge">m</code> is not invertible as: <em>“Throw an
exception”</em>. This is a typical behavior for failure.</p>

<p>In the case where <code class="highlighter-rouge">m</code> is not invertible, the client has satisfied the
precondition (<em>“<code class="highlighter-rouge">m</code> is a valid <code class="highlighter-rouge">Matrix</code>“</em>), but the supplier threw an
exception. This is not against the rule. The rule only says that the
behavior must be <em>defined</em>. <em>“Throw an exception”</em> is a defined
behavior.</p>

<h2 id="other-defined-behaviors">Other defined behaviors</h2>

<p>Other defined behaviors include:</p>

<ul>
  <li>Set a <code class="highlighter-rouge">Status</code> property on the supplier to indicate the status of the
last operation.</li>
  <li>Do nothing on failure (fail silently).</li>
  <li>Loop forever.</li>
  <li>Crash the system.</li>
  <li>And more!</li>
</ul>

<p>The point is that the rule only says the behavior must be <em>defined</em>.</p>

<p>Furthermore, an abnormal return when the precondition is met is
perfectly valid.</p>

<p>Consider a token validator:</p>

<figure class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span class="k">public</span> <span class="k">class</span> <span class="nc">TokenValidator</span>
<span class="p">{</span>

  <span class="c1">// Throws exception if Token is invalid.
</span>  <span class="k">public</span> <span class="k">void</span> <span class="nf">Validate</span><span class="p">(</span><span class="n">Token</span> <span class="n">t</span><span class="p">)</span> <span class="p">{</span> <span class="cm">/* ... */</span> <span class="p">}</span>
<span class="p">}</span></code></pre></figure>

<p>In this case, <em>“Throw an exception”</em> is a success behavior.</p>

<h2 id="work-arounds">Work arounds</h2>

<h3 id="strengthen-the-precondition">Strengthen the precondition</h3>

<p>If you don’t want to handle a certain situation in a supplier, alter the
precondition to preclude that situation.</p>

<p>Note that you cannot strengthen the precondition if existing clients
depend on the supplier handling that situation. In this case, refactor
existing clients to ensure the situation will not arise, or create a new
supplier and mark the old one as deprecated.</p>

<p>Make sure your strengthened precondition adheres to <a href="/software-design-rules/rules/4905c4e9-72cb-4241-9c85-29cc2485e249/" title="Never declare a precondition that the client cannot ensure.">4905c4e9</a>.</p>


  </div>

</article>

      </div>
    </div>

    <footer class="site-footer">

  <div class="wrapper">

    <h2 class="footer-heading">Software Design Rules</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="social-media-list">
          
          <li>
            
              <span class="icon icon--github"><svg viewBox="0 0 16 16"><path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/></svg>
</span><a href="https://github.com/jlapolla/software-design-rules"><span class="username">jlapolla/software-design-rules</span></a>

            
          </li>
          

          
        </ul>
      </div>

      <div class="footer-col footer-col-2">
      </div>

      <div class="footer-col footer-col-3">
        <p>Design rules for effective development.
</p>
      </div>
    </div>

  </div>

</footer>


  </body>

</html>
